{{> header}}
<div>
	<h1>Administración de Productos</h1>

	{{! Crear nuevo producto  }}
	<form id="productForm" class="product-form" action="/api/products" method="post" enctype="multipart/form-data">
		<h4 class="form-group">Nuevo producto</h4>
		<hr />
		<div class="form-group">
			<label for="title">Título:</label>
			<input type="text" id="title" name="title" required />
		</div>
		<div class="form-group">
			<label for="description">Descripción:</label>
			<textarea
				type="text"
				id="description"
				name="description"
				required
			></textarea>
		</div>
		<div class="form-group">
			<label for="code">Código:</label>
			<input type="text" id="code" name="code" required />
		</div>
		<div class="form-group">
			<label for="category">Categoría:</label>
			<input type="text" id="category" name="category" required />
		</div>
		<div class="form-line">
			<div class="form-group">
				<label for="price">Precio:</label>
				<input type="number" id="price" name="price" step="0.01" required />
			</div>
			<div class="form-group">
				<label for="stock">Stock:</label>
				<input type="number" id="stock" name="stock" required />
			</div>
		</div>
		<div class="form-group">
            <label for="thumbnails">Imágenes del producto:</label>
            <input type="file" id="thumbnails" name="thumbnails" multiple />
        </div>
		<div class="form-button">
			<button type="submit">Confirmar</button>
		</div>
	</form>

	{{! Lista de productos }}
	<section class="table-products">
		<table>
			<thead>
				<tr>
					<th>Código</th>
					<th>Categoría</th>
					<th>Título</th>
					<th>Descripción</th>
					<th>Precio</th>
					<th>Stock</th>
					<th></th>
					<th></th>
				</tr>
			</thead>
			<tbody id="productsList">
				{{#each products.docs}}
					<tr id="product{{_id}}">
						<td>{{code}}</td>
						<td>{{category}}</td>
						<td>{{title}}</td>
						<td>{{description}}</td>
						<td>{{price}}</td>
						<td>{{stock}}</td>
						<td>
                            {{#each thumbnails}}
                                <img src="{{this}}" alt="{{../title}}" style="width: 50px; height: 50px;">
                            {{/each}}
                        </td>
						<td><button
								class="delete-btn"
								title="Eliminar producto"
								onclick="deleteProduct('{{_id}}')"
							>Eliminar</button></td>
					</tr>
				{{/each}}
			</tbody>
		</table>
	</section>
	<!-- Paginación -->
	<nav aria-label="Page navigation example">
		<ul class="pagination">
			{{#if products.hasPrevPage}}
			<li class="page-item">
				<a class="page-link" href="{{products.prevLink}}">Previous</a>
			</li>
			{{else}}
			<li class="page-item disabled">
				<a class="page-link" href="#">Previous</a>
			</li>
			{{/if}}

			{{#each products.pageNumbers}}
			<li class="page-item {{#if this.isActive}}active{{/if}}">
				<a class="page-link" href="{{this.link}}">{{this.number}}</a>
			</li>
			{{/each}}

			{{#if products.hasNextPage}}
			<li class="page-item">
				<a class="page-link" href="{{products.nextLink}}">Next</a>
			</li>
			{{else}}
			<li class="page-item disabled">
				<a class="page-link" href="#">Next</a>
			</li>
			{{/if}}
		</ul>
	</nav>	
</div>


{{! Sweet alert }}
<script
	src="https://cdn.jsdelivr.net/npm/sweetalert2@11.10.8/dist/sweetalert2.all.min.js"
></script>

{{! JS cliente  }}
<script src="/static/js/products.js"></script>